# Web 应用安全

## 对称加密与非对称加密

- [聊一聊什么是非对称加密、对称加密、签名、CA 机构、证书、https](https://www.bilibili.com/video/BV1TP411G7wb/?spm_id_from=333.1007.top_right_bar_window_history.content.click&vd_source=bf3353ad677b1fdc2e25b9a255e71902)

**对称加密：**
A 和 B 进行加密通信时，会共用一个密钥进行加解密。但这里存在一个密钥泄露的问题。

**非对称加密：**
`有一个公钥和一个私钥，可以简单理解用公钥加密的这个文件可以用私钥去解密，同时，用私钥加密的文件可以用公钥去解密。这个公钥公开的发送给所有人的，而私钥只有你自己有。`比如 A 有私钥，B|C|D 用 A 的公钥将文件加密后发给 A，只能 A 的私钥解密。

**签名：**

> 非对称加密除了在加密的场景有应用以外，这里还多了一种增信或者信用的场景，也就是签名。一个场景：如果 A 发送一个文件给 B，B 会担心这个文件可能不是 A 发的。

像这种签名的场景，会要求 A 在发送这个文件给 B 之前先用它的私钥进行加密，然后 B 可以拿着 A 的公钥将文件解密，如果解密成功，就说明这个文件是 A 的。这个过程应该不能说成加密解密，而是A进行签名，B进行验签。

1. 公钥加密，私钥解密
2. 私钥签名，公钥验签（防抵赖，鉴权的作用）

> 如上的非对称加密还是不太安全，想一下这样的一个场景，如果B手上的这个A的公钥被黑客调包了呢？那么B就会拿着黑客给的公钥对文件加密，在发给A的过程中又被黑客窃取到了，由于黑客有自己的私钥，可以将这个加密的文件解密查看信息。

> 那么上面这种由公钥不可靠所带来的一个问题，于是出现了CA机构

**CA 机构**
CA机构(certificate authority)，意思是证书授权中心。CA机构会把用户的公钥做一个认证

> 刚刚上面说了B使用A给的公钥被调包了吗，所以呢，我们可以找CA机构给A的公钥做一个公证，盖一个章，这个就是权威机构认证过的了，可以放心使用。

那么CA机构具体是怎么做的呢？
> CA机构会把A的公钥用CA机构自己的私钥去签一个名，然后CA机构会把这种签名过的数据发布到网上，这个数据也就是我们说的证书。然后你就能通过官方的渠道去下载这些证书，这里面就有经过授权过A的公钥。下载这个证书以后，你还要确认是不是CA机构认证过的，你的电脑里会有CA机构的公钥，你可以拿CA机构公钥去验签一下，没有问题，你就可以放心的使用A的公钥了。

最后这里有个问题。刚刚说电脑中存放着CA的公钥，如果这个公钥被调包了怎么办？
> 一般这个调包是很难做的，因为CA机构一般是经过严格审核和认证的，很大的第三方独立机构，大部分的CA机构的公钥会作为一个证书或者根证书被直接的“内置”在操作系统，然后只有具备极高权限系统级或者管理员级的用户才可以调整操作系统中的证书

最后还有个Https堆成和非对称加密的应用场景
> https的加密方式是一种非对称加密和非对称加密综合应用的一种场景。用户先准备一个对称加密的密钥，然后他会用网站提供的一个非对称加密的公钥去把这个自己对称加密的密钥加密，再把这个数据包发给网站，网站再用自己的私钥把数据包解开，之后的通信都拿这个对称加密的密钥加密解密。每次连接结束以后这个对称密钥都会被销毁掉，下一次连接开始，客户端又会准备一个新的对称密钥来确保这种网络通讯的安全。由于非对称加密对于计算消耗大，在Https这个场景，还是只做了一次非对称加密。